name: Auto Pull Request
on:
  push:
    branches:
      - develop

jobs:
  check_open_pr:
    runs-on: ubuntu-latest
    steps:
      - name: Check for open pull requests
        id: check_pr
        uses: octokit/request-action@v2.x
        with:
          route: GET /repos/:owner/:repo/pulls
          owner: ${{ github.repository_owner }}
          repo: ${{ github.event.repository.name }}
          state: open
          head: ${{ github.repository_owner }}:develop
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Create Pull Request
        if: steps.check_pr.outputs.data == '[]'
        uses: peter-evans/create-pull-request@v5
        with:
          branch: feature-build
          title: ${{ github.event.head_commit.message }}
          body: |
            Updates to IntelliTrader
            - Srikrishnan 
            - Auto-generated Pull Request on push to Develop

            - Commit Message Convention
            fix: Represents bug fixes, correlates to a SemVer patch.
            feat: Represents a new feature, correlates to a SemVer minor.
            feat!:, fix!:, refactor!: Represents a breaking change (indicated by the !) and will result in a SemVer major.
            feat(lang): add Polish language
            feat(api)!: send an email to the customer when a product is shipped
            docs: correct spelling of CHANGELOG
            revert: let us never again speak of the noodle incident
          delete-branch: true
          labels: |
            enhancement
            automated pull request
          assignees: iamkrish-coder
          draft: false
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
